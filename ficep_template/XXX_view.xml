<?xml version='1.0' encoding='UTF-8' ?>
<openerp>
    <data noupdate="0">

    <!--
      "options" attribute value for:
      * m2o:                     options='{"always_reload": True}'
                                 options='{"no_open":True}'
                                 options="{'label':{'create':'xxx','edit':'Edit yyy'}}" widget="many2onebutton"
                                 options='{"highlight_first_line": True}'
                                 options='{"create_name_field": "name"}'
      * o2m (avec boutons):      options='{"reload_on_button": true}'
      * widget='image':          options='{"preview_image": "image_small"}' or image_medium
      * widget="mail_thread"     options='{"thread_level": 1}'
      * widget="monetary"        options='{"currency_field" : "xxx"}'
      * widget="sparkline_bar"   options="{'height': '20px', 'barWidth': 4, 'barSpacing': 1}"
      * widget="html"            options='{"safe": True}'
      * widget="gauge"           options="{'max_field': 'invoiced_target'}"
      * widget="many2many_tags"  options="{'no_create_edit': True}"

      "style" attribute value for:
      * widget="gauge"         style="width:160px; height: 120px;"
      * ... (TBC)

      predefined "context" key:
      * o2m:                   context="{'form_view_ref':'form view xml id', 'tree_view_ref':'tree view xml id'}"
      * ... (TBC)

      tree "colors" and "fonts" samples (if any, quoting must be colors="...'xxx'..."):
      * colors="red:date_deadline&lt;current_date;blue:date_deadline==current_date;black:date_deadline&gt;current_date"
      * colors="blue:state == 'draft';grey:state == 'done';red:state not in ('cancel', 'done') and date &lt; current_date"
      * fonts="bold:message_unread==True"

      page:
      * autofocus="autofocus"

      button, field:
      * default_focus="1"
    -->

        <!-- to override a view -->
        <record id="inherit_xml_id" model="ir.ui.view">
            <field name="name">inherit name (current module)</field>
            <field name="model">model</field>
            <field name="inherit_id" ref="inherit_module.inherit_xml_id" />
            <field name="arch" type="xml">
                <xpath expr="//field[@name='xxx']"
                    position="replace | after | before | attributes">
                    <attribute name="yyy">.....</attribute>
                </xpath>
            </field>
        </record>

        <!-- to delete a record: a view for instance -->
        <delete id="module.xmlid" model="ir.ui.view"/>
        <!--  -->

        <!-- All views but forms -->

        <record id="xxx_search_view" model="ir.ui.view">
            <field name="name">xxx.search</field>
            <field name="model">xxx</field>
            <field name="arch" type="xml">
                <search string="XXX" version="7.0">
                    <field name="yyy" />
                    <field name="yyy_id" />

                    <filter name="fff1" string="FFF hhh" domain="[('hhh','=',True)]" />
                    <filter name="fff2" string="FFF ggg" domain="[('ggg','=',True)]" groups="ficep_base.ficep_res_groups_vip_reader" />
                    <separator />
                    <filter name="fff3" string="FFF 3" domain="[('fff','=',True)]" />

                    <filter name="expired" string="Expired"
                            context="{'invisible_expire_date': False}"
                            domain="[('active','=',False)]" help="Expired XXXs" />
                    <filter name="all" string="All"
                            context="{'invisible_expire_date': False}"
                            domain="['|', ('active', '=', True), ('active', '!=', True)]" help="All XXXs, expired or not" />

                    <group expand="0" string="Group By..." name="group_by">
                        <filter name="partner" string="Partner" domain="[]" context="{'group_by':'partner_id'}" />
                        <filter name="category" string="Category" domain="[]" context="{'group_by':'coordinate_category_id'}" />
                    </group>
                </search>
            </field>
        </record>

        <!--delete id="xxx_tree_view" model="ir.ui.view"/-->
        <record id="xxx_tree_view" model="ir.ui.view">
            <field name="name">xxx.tree</field>
            <field name="model">xxx</field>
            <field name="arch" type="xml">
                <tree string="XXX" version="7.0"
                      colors="red:is_duplicate_detected==True">
                    <field name="partner_id" />

                    <field name="coordinate_category_id" />
                    <field name="is_main" />
                    <field name="unauthorized" />
                    <field name="vip" groups="ficep_base.ficep_res_groups_vip_reader" />

                    <field name="expire_date"
                           invisible="context.get('invisible_expire_date', True)" />

                    <field name="coordinate_type" groups="ficep_base.res_groups_developper" />
                    <field name="active" groups="ficep_base.res_groups_developper" />
                    <field name="is_duplicate_allowed"/>
                </tree>
            </field>
        </record>

        <!-- Actions -->

        <!--delete id="xxx_action" model="ir.actions.act_window"/-->
        <record id="xxx_action" model="ir.actions.act_window">
            <field name="name">XXX</field>
            <field name="res_model">xxx</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="xxx_tree_view" />
            <field name="search_view_id" ref="xxx_search_view" />
            <field name="context">{'search_default_xxx': True, 'default_state': 'draft'}</field>
        </record>

        <!-- Finally forms because some action ids can but used on buttons in the form with %(action_xml_id)d convention -->

        <!--delete id="xxx_form_view" model="ir.ui.view"/-->
        <record id="xxx_form_view" model="ir.ui.view">
            <field name="name">xxx.form</field>
            <field name="model">xxx</field>
            <field name="arch" type="xml">
                <form string="XXX" version="7.0">
                    <header>
                        <span attrs="{'invisible': ['|',('id','=',False),('active','=',False)]}"
                             invisible="context.get('popup')"
                             groups="ficep_base.ficep_res_groups_user"><!-- or configurator -->
                            <button name="action_invalidate" string="Invalidate" type="object"
                                    confirm="Invalidate xxx: proceed anyway?" />
                            <button name="set_as_main" string="Set As Main" type="object"
                                    attrs="{'invisible': [('is_main','=',True)]}"
                                    context="{'invalidate': True}"
                                    confirm="Set this coordinate as main and invalidate the previous one: proceed anyway?" />
                        </span>
                        <field name="state" widget="statusbar" statusbar_visible="draft,confirm"/>
                    </header>
                    <sheet>
                        <div class="oe_title" name="title">
                            <label for="name" class="oe_edit_only"/>
                            <h1><field name="name" attrs="{'readonly': ['|',('yyy_ids','!=',[]),('active','=',False)]}" placeholder="e.g. blabla" /></h1>
                        </div>
                        <div class="oe_right oe_button_box" name="buttons" invisible="context.get('popup')">
                        </div>

                        <group name="data">
                            <group name="main">
                                <field name="zzz" attrs="{'readonly': ['|',('yyy_ids','!=',[]),('active','=',False)]}" />
                            </group>
                            <group name="other">
                                <field name="xxx" attrs="{'readonly': ['|',('yyy_ids','!=',[]),('active','=',False)]}" />
                            </group>
                        </group>

                        <group name="state" attrs="{'invisible': [('id','=',False)]}">
                            <group name="validity">
                                <field name="create_date" />
                                <field name="expire_date" attrs="{'invisible': [('active','=',True)]}" />
                            </group>
                            <group name="duplicate">
                                <label for="is_duplicate_detected" attrs="{'invisible': [('is_duplicate_detected','=',False)]}"/>
                                <div attrs="{'invisible': [('is_duplicate_detected','=',False)]}">
                                    <field name="is_duplicate_detected" class="oe_inline" />
                                    <button name="button_all_duplicates" type="action" class="oe_red_link" string="â‡’ Show all duplicates"/>
                                </div>

                                <field name="is_duplicate_allowed" attrs="{'invisible': [('is_duplicate_allowed','=',False)]}" />
                            </group>
                        </group>

                        <notebook invisible="context.get('popup')">
                            <page string="YYY" name="yyy" attrs="{'invisible': [('id','=',False)]}" autofocus="autofocus">
                                <separator string="yyyy yyyy"/>
                                <button string="All Details" name="%(yyy_action)d"
                                        type="action" attrs="{'invisible': [('id','=',False)]}"
                                        context="{'search_default_partner_id': active_id,
                                                  'default_partner_id': active_id,
                                                  'search_default_all': True}" />
                                <field name="yyy_ids" context="{'default_zzz_id': active_id}"
                                       attrs="{'invisible': [('active','=',False)], 'readonly': [('id','=',False)]}">
                                    <tree>
                                        <field name="zzz_id"/>
                                    </tree>
                                </field>
                                <field name="yyy_inactive_ids"
                                       readonly="1" attrs="{'invisible': [('active','=',True)]}">
                                    <tree>
                                        <field name="zzz_id"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                    <div name="dev" class="oe_form_sheetbg" groups="ficep_base.res_groups_developper">
                        <div class="oe_formview oe_form_sheet_width">
                            <h3>More Info</h3>
                            <div attrs="{'invisible': ['|',('id','=',False),('active','=',True)]}">
                                <button name="action_revalidate" string="Reactivate" type="object"
                                        confirm="Reactivate document: proceed anyway?" />
                            </div>
                            <group name="moreinfo">
                                <field name="id"/>
                                <field name="active"/>
                            </group>
                        </div>
                    </div>
                    <div name="chat" class="oe_chatter" invisible="context.get('popup')">
                        <field name="message_follower_ids" widget="mail_followers" groups="ficep_base.ficep_res_groups_configurator"/>
                        <field name="message_ids" widget="mail_thread" />
                    </div>
                </form>
            </field>
        </record>

        <!-- Menu -->

        <menuitem id="xxx_submenu" name="XXX"
                  sequence="40" parent="ficep_mmm.xxx_root_menu" />

        <menuitem id="yyy_menu" action="yyy_action"
                  sequence="10" parent="xxx_submenu" />

        <menuitem id="zzz_menu" action="zzz_action"
                  sequence="20" parent="xxx_submenu" />

    </data>
</openerp>
